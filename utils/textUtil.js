const sensitiveWords = [
  '9浅1深',
  'fuck',
  'manager',
  'shit',
  'a片',
  'smi卡',
  '艾滋',
  '爱慰',
  '爱液',
  '巴氏腺',
  '白带恶臭',
  '斑竹 ',
  '办证',
  '半裸半露',
  '半骚半软',
  '半遮半露',
  '蚌唇',
  '包茎',
  '包皮',
  '胞漏疮',
  '薄熙来',
  '保育细胞',
  '背飞凫',
  '屄',
  '闭经',
  '壁肉',
  '避孕',
  '扁平湿疣',
  '殡仪馆',
  '勃起',
  '不泄',
  '不育',
  '不孕',
  '采购',
  '采精',
  '采阴补阳',
  '蔡英文',
  '操逼',
  '肏',
  '曾荫权',
  '缠抱',
  '肠壁',
  '肠梨形鞭毛虫病',
  '肠源性紫绀',
  '陈水扁',
  '陈希同',
  '耻部',
  '耻骨尾骨肌',
  '耻骨直肠肌',
  '耻毛',
  '耻丘',
  '赤匪',
  '抽插',
  '抽送',
  '初夜',
  '处男',
  '处女',
  '触淫',
  '传染性软疣',
  '吹弹欲破',
  '垂软',
  '春洞',
  '春宫',
  '春情',
  '春心荡漾',
  '春药',
  '戳穴',
  '啜吸',
  '啜著',
  '雌二醇',
  '雌激素',
  '雌性激素',
  '催情',
  '打飞机',
  '打炮',
  '打手枪',
  '大保健',
  '大波',
  '大奶',
  '大乳',
  '大泄',
  '大穴',
  '带状沟',
  '党中央',
  '荡妇',
  '荡叫',
  '岛片',
  '邓小平',
  '电话卡',
  '东亚病夫',
  '董建华',
  '毒品',
  '发春',
  '发浪',
  '发票',
  '发骚',
  '发痒',
  '法轮大法',
  '法轮功',
  '贩卖',
  '房事',
  '房室伤',
  '仿真枪',
  '肥尻',
  '肥奶',
  '肥翘',
  '肥乳',
  '肥臀',
  '肥穴',
  '分销',
  '粉额',
  '粉乳',
  '丰乳',
  '丰臀',
  '丰胸',
  '干过炮',
  '肛',
  '缸交',
  '港独',
  '睾酮',
  '睾丸',
  '工厂店',
  '宫颈',
  '宫内避孕器',
  '宫内膜炎',
  '宫旁组织',
  '宫腔',
  '宫腔粘连',
  '宫外孕',
  '共产党',
  '共匪',
  '供精',
  '狗交',
  '狗爬',
  '挂机',
  '观音坐莲',
  '官方',
  '官方认证',
  '广告相关',
  '国家机构领导人',
  '国家领导人',
  '国务委员',
  '国务院副总理',
  '国务院总理',
  '黑社会',
  '後洞',
  '後进',
  '後穴',
  '换妻',
  '黄冰糖',
  '鸡巴',
  '鸡把',
  '鸡吧',
  '鸡鸡',
  '鸡奸',
  '急性女阴溃疡',
  '急性输卵管炎',
  '急性外阴炎',
  '妓女',
  '奸插',
  '奸弄',
  '奸虐',
  '奸辱',
  '奸尸',
  '奸我',
  '奸淫',
  '姦淫',
  '精液',
  '交而不泄',
  '交媾',
  '交欢',
  '交配',
  '娇喘',
  '娇哼',
  '娇呼',
  '娇叫',
  '娇吟',
  '骄穴',
  '叫床',
  '洁阴法',
  '经销',
  '警官证',
  '军事委员会主席',
  '考生信息名单',
  '口爆',
  '口含',
  '口活儿',
  '口交',
  '狂操',
  '狂插',
  '狂抽',
  '狂捣',
  '狂舐',
  '狂吻',
  '狂泄',
  '窥阴',
  '来搔抚',
  '浪逼',
  '浪喘',
  '浪妇',
  '浪哼',
  '浪货',
  '浪媚',
  '浪穴',
  '浪样',
  '浪吟',
  '老汉推车',
  '李洪志',
  '李克强',
  '理事国',
  '恋母',
  '恋童',
  '梁振英',
  '两腿之间',
  '林郑月娥',
  '淋病',
  '淋菌',
  '淋球菌',
  '淋证',
  '灵肉',
  '令计划',
  '刘云山',
  '龙根',
  '撸着',
  '露阴',
  '卵巢',
  '卵蛋',
  '卵裂',
  '轮奸',
  '绿茶婊 ',
  '绿畜',
  '氯胺酮',
  '马英九',
  '卖淫',
  '毛泽东',
  '毛主席',
  '梅毒',
  '美乳',
  '迷奸',
  '迷药',
  '慕男症',
  '穆斯林',
  '那畜',
  '你妈',
  '匿名',
  '女尻',
  '女阴',
  '女优',
  '排精',
  '膀胱',
  '喷泄',
  '盆腔',
  '屁道',
  '屁门',
  '屁穴',
  '屁眼',
  '嫖娼',
  '破处',
  '破身',
  '破贞',
  '奇淫',
  '前列腺',
  '强暴',
  '强奸',
  '强精',
  '噙住',
  '情欲结',
  '全国人民代表大会',
  '群交',
  '日本鬼子',
  '乳房',
  '乳头',
  '三唑仑',
  '色情相关',
  '色欲',
  '傻B',
  '傻X',
  '傻逼',
  '删贴',
  '少精子症',
  '射精',
  '射液',
  '深插',
  '深喉',
  '生精',
  '生殖',
  '失精',
  '湿疣',
  '手铐',
  '手淫',
  '兽交',
  '刷机',
  '刷级',
  '宋楚瑜',
  '台巴子',
  '台独',
  '统配符',
  '头衔',
  '土共',
  '外阴瘙痒',
  '王岐山',
  '萎软',
  '猥亵',
  '猬亵',
  '温热感',
  '文革',
  '文化大革命',
  '无睾症',
  '无精子症',
  '五征五欲',
  '吸啜',
  '吸功',
  '吸聒',
  '吸吭',
  '吸弄',
  '吸食',
  '吸舔',
  '吸吻',
  '吸咬',
  '习大大',
  '习近平',
  '狎弄',
  '狎玩',
  '下体',
  '下阴',
  '先摸',
  '先射',
  '想操',
  '想舔',
  '消精亡阴',
  '销售',
  '小帮手',
  '小鸡鸡',
  '小乳',
  '小舌',
  '小穴',
  '小助手',
  '邪教',
  '泄精',
  '泄射 ',
  '性爱',
  '性病',
  '性功能',
  '性行为',
  '性交',
  '性洁症',
  '性虐',
  '徐才厚',
  '一本道',
  '一夜情',
  '伊斯兰',
  '佚名',
  '阴唇',
  '阴道',
  '阴核',
  '阴筋',
  '阴茎',
  '阴毛',
  '阴囊',
  '诱奸',
  '俞正声',
  '玉茎',
  '玉乳',
  '玉体',
  '玉腿',
  '玉臀',
  '玉穴',
  '玉麈',
  '欲焰',
  '愈插愈快',
  '约炮',
  '月经',
  '早泄',
  '张德江',
  '张高丽',
  '证件',
  '政治局常务委员',
  '政治类',
  '支那',
  '直销',
  '中华人民共和国',
  '中华人民共和国副主席',
  '中央纪律检查委员',
  '中央军事委员会主席',
  '中央领导机构',
  '中央书记处书记',
  '中央政治局委员',
  '肿涨',
  '肿胀的东西',
  '周恩来',
  '抓揉',
  '专奸',
  '转卖',
  '转销',
  '壮神鞭',
  '子宫',
  '自渎',
  '自慰',
  '自淫',
  '宗教类',
  '总理',
  '总书记',
  '纵欲',
  '最终解释权',
  '作爱',
  '做爱'
]

/**
 * 构建敏感词库，格式为
 * {"半":{"裸":{"半":{"露":{"isEnd":true},"遮":{"isEnd":true}}}},
 * "白":{"带":{"恶":{"臭":{"isEnd":true}}}}}
 * @param sensitiveWords
 * @returns {{}}
 */
function buildSensitiveWordMap(sensitiveWords) {
  var result = {}
  var count = sensitiveWords.length
  //遍历所有的敏感词
  for (var i = 0; i < count; i++) {
    var map = result //将当前敏感词的规则累加在前面计算出来的敏感词规则结果集中
    var word = sensitiveWords[i]
    //遍历敏感词中的每个字
    for (var j = 0; j < word.length; j++) {
      var ch = word.charAt(j)
      //如果该字在敏感词库中已经存在了，则将该字的的结构赋值给map
      if (typeof map[ch] !== "undefined") {
        map = map[ch]
        //如果该字是敏感词中的最后一个字，则代表已经匹配到了敏感词
        if (map['isEnd']) {
          break
        }
      } else {
        if (map['isEnd']) {
          delete map['isEnd']
        }
        map[ch] = {isEnd: true}
        map = map[ch]
      }
    }
  }
  return result
}

function checkSensitiveWordByParams(sensitiveWordMap, content) {
  var result = []
  if (!content) {
    return result
  }
  var count = content.length
  var stack = []
  var point = sensitiveWordMap
  for (var i = 0; i < count; i++) {
    var ch = content.toLowerCase().charAt(i)
    var item = point[ch]
    if (typeof item === 'undefined') {
      i = i - stack.length
      stack = []
      point = sensitiveWordMap
    } else if (item['isEnd']) {
      stack.push(ch)
      result.push(stack.join(''))
      stack = []
      point = sensitiveWordMap
    } else {
      stack.push(ch)
      point = item
    }
  }
  return result
}

function checkSensitiveWord(content) {
  var sensitiveWordMap = buildSensitiveWordMap(sensitiveWords)
  var words = checkSensitiveWordByParams(sensitiveWordMap, content)
  return words.length > 0
}

function checkSpecialCharacters (content) {
  if (!content) {
    return undefined
  }
  return content.match(/[^a-zA-Z0-9\u4E00-\u9FA5]/)
}

module.exports = {
  checkSensitiveWord: checkSensitiveWord,
  checkSpecialCharacters: checkSpecialCharacters
}
